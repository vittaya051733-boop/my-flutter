# ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå

## ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö
‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå

## ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ

### 1. ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Firestore Composite Index
Query ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ `whereIn` + `orderBy` ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ composite index:
```
where('shopId', isEqualTo: xxx)
where('status', whereIn: [...])
orderBy('createdAt', descending: true)
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß:** ‡∏•‡∏ö `orderBy` ‡∏≠‡∏≠‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏ô Dart ‡πÅ‡∏ó‡∏ô (‡πÅ‡∏Å‡πâ‡πÅ‡∏•‡πâ‡∏ß)

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡∏ñ‡∏≤‡∏ß‡∏£:** ‡∏™‡∏£‡πâ‡∏≤‡∏á Composite Index ‡πÉ‡∏ô Firestore

### 2. shopId ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
- `createTestOrder()` ‡πÉ‡∏ä‡πâ `user.uid` ‡πÄ‡∏õ‡πá‡∏ô shopId
- ‡∏´‡∏ô‡πâ‡∏≤ OrderManagement query ‡∏î‡πâ‡∏ß‡∏¢ `_shopId` (‡∏°‡∏≤‡∏à‡∏≤‡∏Å `user.uid` ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô)
- ‡∏ñ‡πâ‡∏≤ login ‡∏î‡πâ‡∏ß‡∏¢ account ‡∏Ñ‡∏ô‡∏•‡∏∞‡∏Ñ‡∏ô ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á

### 3. Status ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏•‡∏¥‡∏™‡∏ï‡πå
Query ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ status: `pending`, `accepted`, `preparing`, `ready`, `delivering`

## ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

### 1. ‡∏î‡∏π Console Log
‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô log:
```
üì¶ Orders found: X
üîë Current shopId: xxxxx
```

### 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏ô Firebase Console
1. ‡πÄ‡∏õ‡∏¥‡∏î: https://console.firebase.google.com/project/vanmarket-50d9d/firestore
2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà collection `orders`
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
   - ‡∏°‡∏µ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
   - `shopId` ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö user ‡∏ó‡∏µ‡πà login ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
   - `status` ‡πÄ‡∏õ‡πá‡∏ô `pending` ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?

### 3. ‡∏•‡∏≠‡∏á Hot Restart ‡πÅ‡∏ó‡∏ô Hot Reload
‡∏Å‡∏î `R` (Shift+R) ‡πÉ‡∏ô terminal ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Restart ‡πÉ‡∏ô VS Code

### 4. ‡∏î‡∏π Error Message
‡∏ñ‡πâ‡∏≤‡∏°‡∏µ error ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏õ‡∏∏‡πà‡∏° "‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà"

## ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÅ‡∏•‡πâ‡∏ß

1. ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° error handling ‡πÉ‡∏ô StreamBuilder
2. ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° debug log ‡πÅ‡∏™‡∏î‡∏á shopId ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
3. ‚úÖ ‡∏•‡∏ö `orderBy` ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å query (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏ô Dart ‡πÅ‡∏ó‡∏ô)
4. ‚úÖ ‡πÅ‡∏™‡∏î‡∏á shopId ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå

## ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö

1. **Hot Restart ‡πÅ‡∏≠‡∏û** (‡∏Å‡∏î R ‡∏´‡∏£‡∏∑‡∏≠ Shift+R)
2. **Login ‡πÉ‡∏´‡∏°‡πà** ‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
3. **‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Order Management** (‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 3)
4. **‡∏î‡∏π Console** - ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏´‡πá‡∏ô:
   ```
   üì¶ Orders found: 1
   üîë Current shopId: abcd1234...
   ```
5. **‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° ‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà**
6. **‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏±‡∏ô‡∏ó‡∏µ**

## ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á

### ‡πÅ‡∏Å‡πâ‡πÅ‡∏ö‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß: ‡∏•‡∏ö where status
‡πÅ‡∏Å‡πâ query ‡πÄ‡∏õ‡πá‡∏ô:
```dart
stream: FirebaseFirestore.instance
    .collection('orders')
    .where('shopId', isEqualTo: _shopId)
    .snapshots(),
```

‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡∏£‡∏ß‡∏° `delivered` ‡πÅ‡∏•‡∏∞ `cancelled`

### ‡∏™‡∏£‡πâ‡∏≤‡∏á Composite Index

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ query ‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:

1. **‡∏£‡∏±‡∏ô Hot Restart** - Firestore ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á error ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á index
2. **‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå** ‡∏à‡∏≤‡∏Å error message
3. **‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå** ‚Üí ‡∏Ñ‡∏•‡∏¥‡∏Å "Create Index"
4. **‡∏£‡∏≠ 2-5 ‡∏ô‡∏≤‡∏ó‡∏µ** ‡πÉ‡∏´‡πâ Firestore ‡∏™‡∏£‡πâ‡∏≤‡∏á index
5. **Restart ‡πÅ‡∏≠‡∏û** ‚Üí ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏•‡πâ‡∏ß

## Debug Checklist

- [ ] ‡∏î‡∏π Console log ‡πÅ‡∏™‡∏î‡∏á shopId ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firestore Console ‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- [ ] shopId ‡πÉ‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö user ‡∏ó‡∏µ‡πà login
- [ ] status = 'pending'
- [ ] Hot Restart ‡πÅ‡∏≠‡∏û‡πÅ‡∏•‡πâ‡∏ß
- [ ] Login ‡∏î‡πâ‡∏ß‡∏¢ account ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
